<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/networkgraph.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>Title</title>
</head>
<body>


<div class="container">
    <div class="col">
        <div style="float: left">
            <img src="logo-recommender.PNG">
        </div>
        <div style="float: left; margin-top: 100px; width: 40%">
            <input class="form-control" type="text" placeholder="Search" type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for names..">
        </div>
        <div style="float: left; margin-top: 105px">
            <span class="material-icons">search</span>
        </div>
        <div style="float: left; margin-top: 100px">
            <button type="button" name="load_data" id="load_data" class="btn btn-info">View Network</button>
        </div>
    </div>


</div>
<div id="network"></div>
<div class="container">
    <div class="table-responsive">
        <br />

        <br />
        <div id="author_table">
        </div>
    </div>
</div>

<!--<table id="myTable">-->
<!--    <tr class="header">-->
<!--        <th style="width:40%;">Name</th>-->
<!--        <th style="width:35%;">Domain</th>-->
<!--        <th style="width:25%;">Citations</th>-->
<!--    </tr>-->
<!--    <tr>-->
<!--        <td>Alfreds Futterkiste</td>-->
<!--        <td>Supervised learning</td>-->
<!--        <td>145</td>-->
<!--    </tr>-->
<!--    <tr>-->
<!--        <td>Berglunds snabbkop</td>-->
<!--        <td>Natural Language Processing</td>-->
<!--        <td>4433</td>-->
<!--    </tr>-->
<!--    <tr>-->
<!--        <td>Yuan Zato</td>-->
<!--        <td>Machine learning, Artificial Intelligence</td>-->
<!--        <td>134</td>-->
<!--    </tr>-->
<!--    <tr>-->
<!--        <td>Koniglich Essen</td>-->
<!--        <td>Deep learning, Artificial Intelligence</td>-->
<!--        <td>33</td>-->
<!--    </tr>-->
<!--</table>-->


</body>
</html>
<script>
    window.onload = function() {
        $.ajax({
            url:"output.csv",
            dataType:"text",
            success:function(data)
            {
                var employee_data = data.split(/\r?\n|\r/);
                var table_data = '<table class="table table-bordered table-striped">';
                for(var count = 0; count<employee_data.length; count++)
                {
                    var cell_data = employee_data[count].split(",");
                    table_data += '<tr>';
                    for(var cell_count=0; cell_count<cell_data.length; cell_count++)
                    {
                        if(count === 0)
                        {
                            table_data += '<th>'+cell_data[cell_count]+'</th>';
                        }
                        else
                        {
                            table_data += '<td>'+cell_data[cell_count]+'</td>';
                        }
                    }
                    table_data += '</tr>';
                }
                table_data += '</table>';
                $('#author_table').html(table_data);
            }
        });
    };
</script>
<script>
    function myFunction() {
        // Declare variables
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("author_table");
        tr = table.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[2];
            if (td) {
                txtValue = td.textContent || td.innerText;
                console.log(txtValue)
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

    }
    function createjson() {
        // Declare variables
        var uk, german, filter, filter2, table, tr, td, tdauthor, i, txtValue, authorname;
        var ukauthors = [];
        var germanauthors = [];
        var nlpauthors = [];
        var dlauthors = [];
        var ccauthors = [];
        uk = 'uk';
        german = 'german';
        filter = uk.toUpperCase();
        filter2 = german.toUpperCase();
        table = document.getElementById("author_table");
        tr = table.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[1];
            tdauthor = tr[i].getElementsByTagName("td")[0];
            if (td) {
                txtValue = td.textContent || td.innerText;
                authorname = tdauthor.textContent || tdauthor.innerText;
                if (txtValue.toUpperCase().includes(filter)) {
                    ukauthors.push(authorname)
                }
                if (txtValue.toUpperCase().includes(filter2)) {
                    germanauthors.push(authorname)
                }
            }
        }
        var authors = [];
        for (var j=0; j<ukauthors.length; j++){
            var couple = ['uk']
            couple.push(ukauthors[j])
            authors.push(couple)
            couple = [];
        }
        for (var h=0; h<germanauthors.length; h++){
            var couple1 = ['german']
            couple1.push(germanauthors[h])
            authors.push(couple1)
            couple1 = [];
        }
        console.log(authors)
        displaynetworkgraph(authors)
    }
</script>
<script>
    $(document).ready(function(){
        $('#load_data').click(function(){

            createjson()
        });

    });
    var ukcolour = "#ecb27b";
    var germancolour = "#b258ea";
    function displaynetworkgraph(authors) {
        Highcharts.chart('network', {
            chart: {
                type: 'networkgraph',
                marginTop: 80
            },
            title: {
                text: 'Network graph'
            },
            plotOptions: {
                networkgraph: {
                    keys: ['from', 'to'],
                    layoutAlgorithm: {
                        enableSimulation: true,
                        integration: 'verlet',
                        linkLength: 100
                    }
                }
            },
            series: [{
                marker: {
                    radius: 30
                },
                dataLabels: {
                    enabled: true,
                    linkFormat: '',
                    allowOverlap: true
                },
                data : authors,
                nodes: [{
                    id: 'uk',
                    color: ukcolour
                },{
                    id: 'german',
                    color: germancolour
                }]

            }]
        });
    }
</script>

<style>
    #container {
        min-width: 320px;
        max-width: 500px;
        margin: 0 auto;
        height: 500px;
    }
</style>
<!--<style>-->
<!--    #myInput {-->
<!--        background-image: url('/css/searchicon.png'); /* Add a search icon to input */-->
<!--        background-position: 10px 12px; /* Position the search icon */-->
<!--        background-repeat: no-repeat; /* Do not repeat the icon image */-->
<!--        width: 100%; /* Full-width */-->
<!--        font-size: 16px; /* Increase font-size */-->
<!--        padding: 12px 20px 12px 40px; /* Add some padding */-->
<!--        border: 1px solid #ddd; /* Add a grey border */-->
<!--        margin-bottom: 12px; /* Add some space below the input */-->
<!--    }-->

<!--    #myTable {-->
<!--        border-collapse: collapse; /* Collapse borders */-->
<!--        width: 100%; /* Full-width */-->
<!--        border: 1px solid #ddd; /* Add a grey border */-->
<!--        font-size: 18px; /* Increase font-size */-->
<!--    }-->

<!--    #myTable th, #myTable td {-->
<!--        text-align: left; /* Left-align text */-->
<!--        padding: 12px; /* Add padding */-->
<!--    }-->

<!--    #myTable tr {-->
<!--        /* Add a bottom border to all table rows */-->
<!--        border-bottom: 1px solid #ddd;-->
<!--    }-->

<!--    #myTable tr.header, #myTable tr:hover {-->
<!--        /* Add a grey background color to the table header and on hover */-->
<!--        background-color: #f1f1f1;-->
<!--    }-->
<!--</style>-->
